% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/popn_age_on.R
\name{popn_age_on}
\alias{popn_age_on}
\title{Age on population}
\usage{
popn_age_on(
  popn,
  col_aggregation = c("year", "gss_code", "age", "sex"),
  col_age = "age",
  col_year = "year",
  timestep = 1,
  template_age_levels = NULL,
  births = NULL
)
}
\arguments{
\item{popn}{Data frame containing a cohort population.}

\item{col_aggregation}{Character vector of columns in \code{popn} acting as
aggregation levels. Default \code{c("year","gss_code","age","sex")}. In the case
of multiple geography columns, only supply the highest resolution column;
other columns will be preserved.}

\item{col_age}{String denoting the age column. Default "age".}

\item{col_year}{String denoting the year column. Can be NULL. Default "year".}

\item{timestep}{Numeric denoting the model time step in years. If age data
are numeric, they must be spaced by this interval. If they are an ordered
factor, the function will advance the age by one age band regardless of
this parameter. The \code{col_year} column, if present, will also be
increased by \code{timestep} years. Default 1.}

\item{template_age_levels}{Numeric vector or a factor giving the expected
levels for the population's ages. This is an optional validation tool that
runs an extra check to make sure all expected levels are present. Default
NULL.}

\item{births}{Data frame, 0 or \code{NULL}. Births data at the same
aggregation levels as \code{popn} but coded to the lowest age band that can
be joined to the output with \code{rbind}. If zero, then the output rows for
zero-year-olds, all of which are zero. These settings currently only work
when \code{col_aggregation} is set to the default
\code{c("year","gss_code","age","sex")}. If \code{NULL} then no
zero-year-olds are included in the output. Default \code{NULL}.}
}
\value{
A data frame containing the population with age advanced by one time
  step (or age band). The lowest age will not be present in this output. Rows
  are arranged iby \code{col_aggregation}, in that order.
}
\description{
Given a cohort population, advance the cohort's age by one timestep/age band
and (if specified) increase the date year.
}
\details{
The function works with cohort age data as either numeric data or as an
ordered factor (e.g. age bands). If age is numeric then all age bands must be
equally spaced by the interval given in \code{timestep}, usually 1.

Ageing of the population is done by either adding the timestep to the age
(for a numeric age) or by incrementing to the next level of the factor (for
age as an ordered factor)./ If \code{col_year} is given, the year will also
be increased by \code{timestep}.

The highest age/age band is considered to be unbounded. This means that when
a population is aged on, the population in this band remains in this band,
and the age/band below it is added to it. An ageing population will all
eventually be moved into this age band if no other processes are operating.

When age bands are merged like this, the function combines data in other
columns using the following (crude) rules: if the data are numeric, sum them,
otherwise check they're an identical category (i.e. not age-dependent) and
return the value, otherwise throw an error. (So make sure year data are
specified in \code{col_aggregation})
}
