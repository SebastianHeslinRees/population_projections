---
output:
  html_document:
    toc: true
    toc_depth: 1
    number_sections: yes
    includes:
      before_body: header.html
      after_body: footer.html
    css: "style.css"
  pdf_document: default
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
knitr::opts_chunk$set(fig.width=12)
```

```{r library, include=FALSE}
library(dplyr)
library(knitr)
library(data.table)
source("model_code/markdown/2021_projections/demog_plotly.R")
```

```{r number_in_text}

number_in_text <- function(x){
  
  type <- case_when(abs(x) < 1000 ~ "small",
                    abs(x) < 999999 ~ "thousand",
                    TRUE ~ "million")
  
  if(type == "small"){
    return(round(x, -1))
  }
  
  if(type == "thousand"){
    return(paste(round(x/1000,0),type))
  }
  
  if(type == "million"){
    x <- as.character(round(x/1000000,2))
    
    if(nchar(x)==1){
      a <- ".000"
      x <- paste0(x, a)
    }
    
    if(nchar(x)<5){
      a <- paste(rep("0", 5-nchar(x)), collapse="")
      x <- paste0(x, a)
    }
    
  }
  return(paste(x,type))
  
} 

get_percent <- function(a,b,places=1){
  round(((b-a)/a)*100,1)
}

```

```{r charts, out.width = "100%"}
charts <- readRDS("outputs/markdown/2021_results_doc_charts.rds")
```

<div class="h1-title">Executive Summary</div>

```{r include = FALSE, echo = FALSE}

data <- plotly_data(charts[['popn']])
a <- round((filter(data, x_axis_col == 2050, colour_col == "Central")$y_axis_col)/1000000,3)
b <- round((filter(data, x_axis_col == 2050, colour_col == "Short")$y_axis_col)/1000000,3)
c <- round((filter(data, x_axis_col == 2050, colour_col == "Long")$y_axis_col)/1000000,3)


data <- plotly_data(charts[['trend-vs-hlm']]) %>% filter(year == 2041)
e <- round(data$`Identified Capacity`/1000000,3)
f <-  round(data$`Past Delivery`/1000000,3)
g <- round(data$`Housing Targets`/1000000,3)

```

The 2021-based population projections comprise both *variant trend projections* and *housing-led scenario projections*. Trend projections are based on the continuation of past trends in population change while the housing-led projections incorporate considerations of future housing delivery into the projection process. Trend projections are most appropriate for strategic planning at the regional level while for most other uses the GLA recommends the housing-led projections. Trend projections are available for all local authority districts in England and Wales and at the national level for Northern Ireland and Scotland. Housing-led projections are available for London Boroughs and London wards.

The 2021-based based projection take as their starting point the 2021 mid-year estimate (MYE). This is a rolled-forward estimate from the 2021 census population estimate and is the most recent official estimate of London's population. A backseries of population and components of population change for the period 2012-2020 has been modelled by the GLA for use in these projections.

This report provides a summary of the range of projected population for London and the London Boroughs.

- London's mid-2021 population was 8.797 million (<a target="_blank" href='https://data.london.gov.uk/dataset/londons-population/'>2021 mid-year estimate</a>).
- The Central projection has a population of `r a` in million in 2050.
- The range between the Short and the Long projections spans a population of between `r b` million and `r c` million in 2050.


<div class="h2-title">Trend projections</div>

```{r exec_chart, out.width = "100%"}
charts[['exec summary']] 
rm(data, a, b, c, e, f, g)
```

The 2021-based trend projections include three variants which differ in their assumptions about future migration behaviour (both international and domestica). These variants are based on averaging past periods of observed migration behviours. The variants are: 

- The Central projection (10-year migration averages)
- The Short variant (5-year migration averages)
- The Long variant (15-year migration averages)


<div class="h2-title">Housing-led projections</div>

The 2021-based housing-led projections include three scenario projections based on different levels of future housing availability. They are:  

- *Identified Capacity scenario* which uses a development trajectory adapted from the Strategic Housing Land Availability Assessment (SHLAA).  
- *Past Delivery scenario* which assumes average of delivery over the period 2012-2019 will continue.  
- *Housing Targets scenario* in which the London Plan target of 52,287 units is delivered in each year of the projection.

In producing the projections no assumption has been made about the likelihood of these delivery scenarios coming forward - the projections are designed to illustrate how the population might change under the conditions described in the scenarios. At the London level all housing-led projections are constrained to the central trend projection.

Due to limited information about potential development sites in the very long term, the housing-led projections have a projection horizon of 2041.


# Introduction

<a href="#top">Back to top</a>

The GLA Demography team produce a range of population projections which are used to help inform planning and policy work within the GLA and across London. Projections are updated annually, incorporating the latest data as it becomes available.

The two main types of population projection produced are *trend-based* projections, which are based on a cohort component model that uses past trends in births, deaths and migration to project future populations, and *housing-led* projections, which reconcile future population growth with forecast housing supply.

This summary document outlines the results of the GLAâ€™s 2021-based population and household projections which were released in January 2023.

The 2021-based projections take as their starting point the most recent ONS Mid-Year Estimate (mid-2021). This is a rolled-forward estimate from the 2021 census estimate. A backseries of population and components of population change for the period 2012-2020 has been modelled by the GLA for use in these projections.

The trend projections comprise a set of variants based on different assumptions about future migration levels. The housing-led projections include a set of scenarios across which the migration assumptions are consistent but the levels of housing delivery in London differ. The production of these variants and scenarios has been driven by the desire to meet the needs of a wide range of users.

In producing the projections no assumptions have been made about the likelihood of these migration variants or housing delivery scenarios coming forward - the projections are designed to illustrate how the population might change under the conditions described in the variants/scenarios.

Detailed methodology documents are provided alongside each set of population projections which can help users decide which set of population projections is most appropriate for their needs.


# Trend projections

<a href="#top">Back to top</a>

Three variant projections have been produced: a central projection, and two projections which bound a wider plausible range. These variants have been produced in order to assist users in understanding current uncertainty about future population growth. The projections differ in their assumptions about future levels of domestic and international migration, they are:

- The Central projection (10-year migration averages)
- The Short variant (5-year migration averages)
- The Long variant (15-year migration averages)

The projections move forward from a starting point of mid-2021. In the first year of the projection (2022) international migration levels are constrained to be consistent with UK-level data on international flows published by ONS.

Corresponding household projections have been run for each population output. Two sets of household projections are available for each trend variant: one set using the ONS 2018-based household model and one set using the 2014-based DCLG household model.

## Expert Panel

<a href="#top">Back to top</a>

For recent rounds of population projections the GLA sought the guidance of an expert panel of academics and professional demographers insetting the projection input parameters. The panel were consulted on the economic and social drivers of population change in both the short-term and long-term, as well as the specifics of component trajectories. Their input was key in shaping the assumptions which formed the 2019-based and 2020-based variant projections. A summary of the consultation responses and recommendations is available on the <a target="_blank" href="https://data.london.gov.uk/dataset/population-projections-documentation/">London Datastore</a>.

For the 2021-based projections the GLA has returned to a statistical approach to assumption-setting. We believe that the three trajectories, based on varying years of migration data, provide a reasonable range of likely future population change. As such, the expert panel's input was not sought for this round of projections.

# Interpreting variant projections

```{r include = FALSE, echo = FALSE}
data <- plotly_data(charts[['popn']]) %>%  filter(colour_col == "Central")
a <- filter(data, x_axis_col == 2021)$y_axis_col
b <- filter(data, x_axis_col == 2050)$y_axis_col
central_future <- format(round((b-a)/30,-2), big.mark = ",")

#--
d <- filter(data, x_axis_col == 2011)$y_axis_col
e <- filter(data, x_axis_col == 2021)$y_axis_col
actual_past <- format(round((e-d)/10,-2), big.mark = ",")

#--

data <- plotly_data(charts[['popn']]) %>%  filter(colour_col == "Short")
g <- filter(data, x_axis_col == 2021)$y_axis_col
h <- filter(data, x_axis_col == 2050)$y_axis_col
short_future <- format(round((h-g)/30,-2), big.mark = ",")

#--

data <- plotly_data(charts[['popn']]) %>%  filter(colour_col == "Long")
j <- filter(data, x_axis_col == 2021)$y_axis_col
k <- filter(data, x_axis_col == 2050)$y_axis_col
long_future <- format(round((k-j)/30,-2), big.mark = ",")

#---

data <- plotly_data(charts[['dom net']]) %>%  filter(colour_col == "10-year average")
g <- round(filter(data, x_axis_col == 2017)$y_axis_col,-2)*-1
dom_max <- format(g, big.mark = ",")
rm(a,b,d,e,g,h,j,k)
```

<a href="#top">Back to top</a>

The 2021-based variant projections provides users with three population trajectories. These variants give an indication of the effect of different levels of migration on population size and structure. 

The last two decades have seen a number of shocks which might be expected to have significantly impacted international flows: EU expansion in 2004, 2007 and 2013; the credit crunch, housing crisis and great recession beginning in 2008; the EU referendum in 2016; and major changes to UK migration policy throughout the period. However, absolute levels of international migration have been relatively stable, lending weight to the idea of the resilience of long-term trends. 

The three  2021-based projection variants use differing levels of migration - both domestic and international - and assumes that that level remains consistent throughout the projection period. Projected domestic flows are calculated by applying averaged rates of migration while international in and out migration are input as static flows.

- *Central* - uses an average of the last 10 years of migration flows (2012-2021) 
- *Short* - uses an average of the last five years of migration flows (2017-2021).
- *Long* - uses an average of the last 15 years of migration flows (2007-2021).  

The ten-year 'central' average captures a wide range of behaviours across the economic cycle, including the lower levels of mobility observed following the financial crisis. The five-year average provides a higher migration scenario - the last five years have been a period of relatively high migration with a peak in 2017 when net out migration from London reached `r dom_max` people. Use of the five-year average represents an assumption that recent levels become the norm even after accounting for potential variation over the economic cycle.

The inclusion of data covering the period from mid-2019 to mid-2021 in the averaging was carefully considered. Although the data for these years does include the impacts of COVID-19 on population movement, the range of variants provides users with a clear indication of the range of plausible future growth when migration inputs are varied. 

The Central projection projects annualised growth of `r central_future` per year over the period to 2050. This is in the context of average growth of `r actual_past` per year in London over the last decade.

<div class="table-title">Table 1: Annualised population change, London</div>
```{r}

tibble(variant = c("Observed",
"Central",
"Short",
"Long"),
period = c("2011-2021",
"2021-2050",
"2021-2050",
"2021-2050"),
`annual change` = c(actual_past,
central_future,
short_future,
long_future)) %>% 
DT::datatable(rownames = FALSE, filter = "none",  caption = "persons",
options = list(paging=FALSE, searching=FALSE, info=FALSE)) 


```


## Projections for areas outside London

The detailed variant projections outputs include data for all local authorities in England and Wales as well as national-level data for Northern Ireland and Scotland. This report presents the results for London only. Data for areas beyond the Greater London boundary are primarily published for the purpose of transparency and do not necessarily reflect the organisationâ€™s view of future growth outside of the city. 

# Methodology

<a href="#top">Back to top</a>

A paper on the models, methodologies and configuration options used in producing these projections is available to download from the <a target="_blank" href="https://data.london.gov.uk/dataset/population-projections-documentation/">London Datastore</a>. 


# Trend projections Results {.tabset}

<a href="#top">Back to top</a>

## Projections in the Short-term

```{r, include = FALSE, echo = FALSE}
# The diff between 2020 and 2021 in London
a <- plotly_data(charts[['covid']]) %>% 
filter(variant == "Central Lower")
b <- filter(a, year == 2020)$popn
c <- filter(a, year == 2021)$popn
a <- round((b-c)/1000,0) 
rm(b,c)
```

The initial short-term period of the projections incorporates additional intelligence about population change not included in the mid-year estimate series. In the first projection year (2022) international migration at the UK level is adjusted to be consistent with data from the ONS on flows for that year. This year saw extremely high in-migration flows as a result of significant flows from Ukraine and Hong Kong and a 'bounce back' following the lifting of covid restrictions.

Over the following two years (2023-2024) migration assumptions diverge as levels of migration transition incrementally towards the long-term values set for each variant. These long-term levels come into effect in 2025.


```{r chart_covid, out.width = "100%"}
charts[['covid']]
```

## Long-term projections

```{r, include = FALSE, echo = FALSE}
data <- plotly_data(charts[['int net']])
int_net_10 <- filter(data, x_axis_col == 2025, colour_col == "10-year average")$y_axis_col %>% number_in_text()
int_net_5 <- filter(data, x_axis_col == 2025, colour_col == "5-year average")$y_axis_col %>% number_in_text()
int_net_15 <- filter(data, x_axis_col == 2025, colour_col == "15-year average")$y_axis_col %>% number_in_text()

data <- plotly_data(charts[['popn']])

central_decade <- filter(data, x_axis_col %in% c(2021,2031), colour_col == "Central") %>% mutate(y_axis_col = ifelse(x_axis_col == 2021, y_axis_col*-1, y_axis_col)) %>% pull(y_axis_col) %>% sum() %>% number_in_text()

short_decade <- filter(data, x_axis_col %in% c(2021,2031), colour_col == "Short") %>% mutate(y_axis_col = ifelse(x_axis_col == 2021, y_axis_col*-1, y_axis_col)) %>% pull(y_axis_col) %>% sum() %>% number_in_text()

long_decade <- filter(data, x_axis_col %in% c(2021,2031), colour_col == "Long") %>% mutate(y_axis_col = ifelse(x_axis_col == 2021, y_axis_col*-1, y_axis_col)) %>% pull(y_axis_col) %>% sum() %>% number_in_text()

rm(data, popn_2021)
```

Beyond 2025, long-term levels of migration are reached and maintained.

In the Central projection, international migration returns to the 10-year average (net `r int_net_10`) while in the Short variant international migration is `r int_net_5` per year and in the Long variant `r int_net_15` per year.

All three variants project population growth over the period, albeit to varying levels. London grew by 1 million people in in the decade to 2011 and then around 800 thousand people in the the decade to 2021. Over the decade to 2031, the Central Population variant sees growth of `r central_decade` while the in Short Population variant London is projected to grow by `r short_decade` and in the Long variant projected growth to 2030 is `r long_decade`.

<div class="table-title">Table 2: Variant population projections, London</div>
```{r growth_table}
charts[['table growth']] %>% 
DT::datatable(rownames = FALSE, filter = "none", caption = "population (millions)",
options = list(paging=FALSE, searching=FALSE, info=FALSE))
```
<div class="source">Source: GLA 2021-based population projections</div>


```{r chart_popn, out.width = "100%"}
charts[['popn']]
```

## Comparison to 2020-based

```{r}
data <- plotly_data(charts[['popn']])
a <- filter(data, x_axis_col == 2050, colour_col == "Short")$y_axis_col
b <- filter(data, x_axis_col == 2050, colour_col == "Long")$y_axis_col
c <- filter(data, x_axis_col == 2050, colour_col == "Central")$y_axis_col
rm(data)
```

The 2020-based GLA trend projections were released in September 2021. The differences between the last round and the 2021-based projections are significant, the primary reason bring that the population backseries used in the two rounds of projection is different.

The 2020-based projections used the 2020 mid-year estimate (MYE) as their jumping-off point. This MYE was the last estimate in a series which began in 2011. Each subsequent year from 2012 forward was calculated by adding estimated components of change to the previous year's population estimate. As such, over the decade, the MYE series had drifted away from the true population count.

The 2021 census has provided an opportunity to reset the mid-year estimate series using the new data census as a starting point. The 2021 estimate therefore represents a break in the previous series. In order to create a consistent back series between the 2021 and 2011 estimates the GLA has modelled population and components of change for that period.

The existing ONS 2020 MYE for London was 9.002 million. The GLA's revised estimate for that year is 8.878 million, around 125 thousand persons lower. This difference represents the inflation in the existing ONS MYE series over the last decade.

The 2021-based projections use the 2021 MYE as their starting point and the modelled GLA backseries for the calculation of trends. As the ONS series had overestimated the level of population growth in London the previous set of projections projected stronger growth into the future when compared to the 2021-based projections. In the 2020-based projections the Central Range of population in 2050 was 10.319 million to 10.707 million, while for 2021-based projections growth is projected to range between `r number_in_text(a)` and `r number_in_text(b)`. The Central projection has a population of `r number_in_text(c)` in 2050.

```{r chart_comp, out.width = "100%"}
charts[['comp']]
```


# Age structure

The age structure in 2037, after 15 years of projected change, is shown in the chart below. Age structure has implications for household growth trajectories (see the section on households below) where household formation rates differ by age.

```{r chart_sya, out.width = "100%"}
charts[['age structure']]
```

# Working age population

The size of the working age population (16-64) in London is heavily dependent on the level of migration. High net out migration as seen in the Short Population variant leads to a decline in the working age population over time. In the Long Population variant, which has a low net out migration, the population grows over the period to 2050.

The Central variant sees growth up to 2040 and then a leveling-off in the last decade of the projection.

```{r chart_working, out.width = "100%"}
charts[['working age']]
```

<div class="table-title">Table 3: Working age population, London</div>
```{r table_working}
charts[['table working']] %>% 
DT::datatable(rownames = FALSE, filter = "none",  caption = "population (millions)",
options = list(paging=FALSE, searching=FALSE, info=FALSE))
```

# Components of Change {.tabset}

<a href="#top">Back to top</a>

Births, deaths and migration all contribute to Londonâ€™s changing population. Natural change, which is the difference between the number of births and deaths, is the largest direct contributor to Londonâ€™s population growth. Natural change is comparatively high in London because its age structure is much younger than that of the rest of the UK.

As noted above, Londonâ€™s relatively youthful population is a result of established patterns of migration to and from the capital, which give rise to a net inflow of young adults and a net outflow of all other age groups. 


## Total migration

```{r}
data <- plotly_data(charts[['total net']])
a <- filter(data, x_axis_col == 2021, colour_col == "Central")$y_axis_col
d <- filter(data, x_axis_col %in% 2002:2019, colour_col == "Central")$y_axis_col

data <- plotly_data(charts[['int net']])
c <- round((filter(data, x_axis_col == 2022, colour_col == "10-year average")$y_axis_col)/1000,0)

```


Total net migration is the sum of all flows in to and out of an area. This includes both international and domestic flows. Historically, London has seen large gross flows both in and out of the capital which have largely cancelled each other out. Over the period 2002-2019 total net migration ranged between `r number_in_text(min(d))` thousand and `r number_in_text(max(d))`.

COVID-19 saw significant disruption to migration flows both domestically and internationally. In particular, 2021 saw significantly higher than normal net outflows from London (`r number_in_text(a)`). Flows in the initial year of the projection (2022) include data from ONS on international migration at the UK level. The year to mid-2022 saw the highest net inflow of international migrants to the UK on record (504 thousand). This was in part a response to the easing of covid restrictions but was also influenced by significant migrations from Ukraine and Hong Kong. This UK-level data has been used to model a net international inflow to London of `r number_in_text(c)` in 2022.

```{r chart_total, out.width = "100%"}
charts[['total net']]
```

## International migration

International migration assumptions provide the basis for much of the variation between the four projection variants. There are three international migration scenarios: a high (15-year average), a central (10-year average), and a low (5-year average).

Net international migration in the high scenario is `r int_net_15` persons per year, in the central scenario is 96 `r int_net_10` persons per year and in the low scenario is `r int_net_5` persons per year. These levels are achieved in 2025 in the modelling. The period 2020-2022 has its own international migration profile which is consistent across all three scenarios. The period 2023-2024 is a transition period over which levels of migration move from the 2022 level to the 2025 level. 


```{r chart_int_a, out.width = "100%"}
charts[['int net']]
```

```{r chart_int_b, out.width = "100%"}
charts[['int in']]
```

```{r chart_int_c, out.width = "100%"}
charts[['int out']]
```

```{r}

dom_net_past <- readRDS("input_data/mye/2021/dom_net_gla.rds")

ldn_dom_net_10 <- filter(dom_net_past, gss_code == "E12000007", year %in% 2012:2021) %>% 
group_by(year) %>% 
summarise(dom_net = sum(dom_net*-1), .groups = 'drop_last') %>% 
data.frame() %>%
pull(dom_net) %>% 
mean() %>%
number_in_text()

ldn_dom_net_5 <- filter(dom_net_past, gss_code == "E12000007", year %in% 2017:2021) %>% 
group_by(year) %>% 
summarise(dom_net = sum(dom_net*-1), .groups = 'drop_last') %>% 
data.frame() %>%
pull(dom_net) %>% 
mean() %>%
number_in_text()

ldn_dom_net_15 <- filter(dom_net_past, gss_code == "E12000007", year %in% 2007:2021) %>% 
group_by(year) %>% 
summarise(dom_net = sum(dom_net*-1), .groups = 'drop_last') %>% 
data.frame() %>%
pull(dom_net) %>% 
mean() %>%
number_in_text()

```

## Domestic migration

The balance of domestic migration in London has been consistently negative for the last two decades. This means that more people leave the capital each year for other areas of the UK than move to London. Higher rates of domestic migration overall lead to a higher net outflow from London and correspondingly slower population growth.

Over the last decade average outflow from London was `r ldn_dom_net_10`. The average of the last 15 years is lower at `r ldn_dom_net_15` as this period includes the Great Recession when domestic flows were lower across the UK in response to economic uncertainty and impacts on the housing market. In more recent years the combined impacts of COVID-19 and Brexit have meant significantly higher levels of domestic out migration from London. The 5-year average outflow for the period 2017-2021 was `r ldn_dom_net_5`.


```{r chart_dom_a, out.width = "100%"}
charts[['dom net']]
```

```{r chart_dom_b, out.width = "100%"}
charts[['dom in']]
```

```{r chart_dom_c, out.width = "100%"}
charts[['dom out']]
```

## Births

```{r}

births_2021 <- readRDS("input_data/mye/2021/births_gla.rds") %>% 
filter(gss_code == "E12000007", year == 2021) %>% 
pull(births) %>% 
sum()

```

Annual births in London rose by approximately 30 per cent over the decade from 2002 to 2012. Since then the number of births has fallen and in 2020 was `r number_in_text(births_2021)`, similar to the level last seen in 2003.

The same fertility rates are applied in each of the variants. The difference in births is a function of the differing size and composition of the population in each variant. In all cases an initial period of falling births is followed by steady increase. The number of births peaks and stabilises at the end of the projection as the number of women of child-bearing age in the population reaches an equilibrium.


```{r chart_births, out.width = "100%"}
charts[['births']]
```

## Deaths

```{r}

deaths_2021 <- readRDS("input_data/mye/2021/deaths_gla.rds") %>% 
filter(gss_code == "E12000007", year == 2021) %>% 
pull(deaths) %>% 
sum()

```

The same mortality rates are applied in each of the variants. The difference in deaths is a function of the differing size and composition of the population in each variant.

The impact of COVID-19 can be seen in the deaths occurring over the period 2019-2021. From 2022 on deaths from COVID-19 are assumed to be accounted for through the normal application of mortality rates.

```{r chart_deaths, out.width = "100%"}
charts[['deaths']]
```

## Natural change

Natural change is the balance of births and deaths over the year. It is the largest direct contributor to London's growth. In 2021 natural change added `r number_in_text(births_2021 - deaths_2021)` persons to the London population.

```{r chart_nc, out.width = "100%"}
charts[['natural change']]
```

# Household projections {.tabset}

<a href="#top">Back to top</a>

For each population projection variant, household projections have been run using adapted versions of the ONS 2018-based household projection model and the 2014-based DCLG household model. 

## ONS Household projections

The ONS model is the official household model for England and was used by ONS in the preparation of the 2018-based household projections. 

<div class="table-title">Table 4: Variant household projections (ONS household model), London</div>
```{r ons_table}
charts[['ons table']] %>% 
  DT::datatable(rownames = FALSE, filter = "none",  caption = "households (millions)",
                options = list(paging=FALSE, searching=FALSE, info=FALSE))
```
<div class="source">Source: GLA 2021-based projections, ONS 2018-based household model</div>

```{r chart_ons_hh, out.width = "100%"}
charts[['ons hh']]
```

<div class="table-title">Table 5: Annualised household change (ONS household model) </div>
```{r ons_table_2}
charts[['ons annualised']] %>% 
  setnames(c("variant","households 2043", "change 2018-2043", "annualised change")) %>% 
  DT::datatable(rownames = FALSE, filter = "none",
                options = list(paging=FALSE, searching=FALSE, info=FALSE,
                               columnDefs = list(list(className = 'dt-right', targets = 1:3))))
```
<div class="source">Source: GLA 2021-based projections, ONS 2018-based household model</div>


## DCLG Household projections

The DCLG model was the official household model for England for the preparation of the 2014-based household projections. Outputs from this model remain relevant due to its continued use by DLUHC in the preparation of housing targets.

<div class="table-title">Table 6: Variant household projections (DCLG household model), London</div>
```{r dclg_table}
charts[['dclg table']] %>% 
  DT::datatable(rownames = FALSE, filter = "none", caption = "households (millions)",
                options = list(paging=FALSE, searching=FALSE, info=FALSE))
```
<div class="source">Source: GLA 2021-based projections, DCLG 2014-based household model</div>

```{r chart_dclg_hh, out.width = "100%"}
charts[['dclg hh']]
```

<div class="table-title">Table 7: Annualised household change (DCLG household model) </div>
```{r dclg_table_2}
charts[['dclg annualised']] %>% 
  setnames(c("variant","households 2043", "change 2018-2043", "annualised change")) %>% 
  DT::datatable(rownames = FALSE, filter = "none",
                options = list(paging=FALSE, searching=FALSE, info=FALSE,
                               columnDefs = list(list(className = 'dt-right', targets = 1:3))))

```
<div class="source">Source: GLA 2021-based projections, DCLG 2014-based household model</div>


# Housing-led projections

<a href="#top">Back to top</a>

The housing-led projections are produced for London boroughs and wards. The GLA suggests that these projections provide the best estimate of future populations at these geographic resolutions. This is because the additional intelligence on the capacity of smaller areas to accommodate population, in the form of available housing stock, provides a more realistic view of future population. The GLA recommends the housing-led projections for most purposes.

Unlike the trend projections which have a projection horizon of 2050, the housing-led projections work to a projection horizon of 2041. This is because the availability, reliability and utility of housing delivery data diminishes over time.

The 2021-based housing-led projections comprise three scenario projections each of which uses a different housing delivery trajectory. In producing the projections no assumption has been made about the likelihood of these delivery scenarios coming forward - the projections are designed to illustrate how the population might change under the conditions described in the scenarios.

```{r include = FALSE, echo = FALSE}
a <- plotly_data(charts[['stock']])
b <- unique(filter(a, x_axis_col == 2020)$y_axis_col)

c <- filter(a, x_axis_col == 2041, colour_col == "Identified Capacity")$y_axis_col
d <- round((c-b)/1000,0)
e <- get_percent(b,c)

f <- filter(a, x_axis_col == 2041, colour_col == "Past Delivery")$y_axis_col
g <- round((f-b)/1000,0)
h <- get_percent(b,f)

i <- filter(a, x_axis_col == 2041, colour_col == "Housing Targets")$y_axis_col
j <- round((i-b)/1000000,3)
k <- get_percent(b,i)
```


## Identified Capacity Scenario

<a href="#top">Back to top</a>

This scenario adapts the 2017 <a target="_blank" href="https://www.london.gov.uk/what-we-do/planning/london-plan/new-london-plan/strategic-housing-land-availability-assessment">Strategic Housing Land Availability Assessment (SHLAA)</a> housing capacity study for use as a future delivery scenario. A SHLAA is a technical exercise to determine the quantity and suitability of land potentially available for housing development. It is a required part of the evidence base needed for the preparation of a Local Plan.

In the initial years of the projection the delivery assumptions have been amended to reflect housing market analysis undertaken by Savills Estate Agents. In 2020 assumed delivery is 41,700 while for 2021-2025 it is 43,000 per annum. The total delivery over this period is 256,700 while the SHLAA capacity identifies 333,100 units over the same period. The difference (76,400) is assumed to come forward over the period 2026-2041 and is distributed to the trajectory for those years.

In later years the trajectory assumes lower levels of delivery. Whilst this is unlikely to be a reality for Londonâ€™s future growth, it is a reflection that the SHLAA, on which this delivery scenario is based, is a capacity study that - due to information available on site availability and deliverability at the time - is better able to identify sites in the short-to-medium term. In the longer-term SHLAA capacity is based on less reliable assumptions about sites that may come forward for housing delivery. This is due to an inability to predict market changes or development patterns that could result in brownfield land not currently suitable for housing becoming available. As a result, annual delivery in later years is much lower than the initial years of the trajectory, however in reality this is unlikely to occur.

In the Identified Capacity scenario, the number of dwellings in London is forecast increase by `r d` thousand over the 21-year period to 2041. This is an increase of `r e`% over current stocks.

## Past Delivery Scenario

<a href="#top">Back to top</a>

This scenario assumes that the average of past levels of development, as reported in the London Development Database (LDD) will come forward each year for the period 2022-2041.

In the initial years of the projection, the level of delivery is assumed to be the same as in the Identified Capacity scenario: 41,700 in 2020 and 43,000 in 2021. The underlying assumption being that this recently developed intelligence, undertaken in 2021 during the pandemic, provides the most reasonable estimate of short-term delivery. Beyond 2021, the LDD average of 31,100 units is used.

In this scenario, the number of dwellings is forecast to increase by a total of  `r g` thousand units over the 21-year period to 2041. This is an increase of `r h`% over current stocks.

## Housing Targets Scenario

<a href="#top">Back to top</a>

This scenario assumes that the London Plan target of 52,300 dwellings will be delivered in each year of the projection period up to 2041. In the initial years of the projection, the level of delivery is assumed to be the same as in the Identified Capacity scenario: 41,700 in 2020 and 43,000 in 2021. The underlying assumption being that this recently developed intelligence, undertaken in 2021 during the pandemic, provides the most reasonable estimate of short-term delivery.

In the Housing Targets scenario, the number of dwellings is forecast to increase by `r j` million units over the 21-year period to 2041. This is an increase of `r k`% over current stocks.

```{r include = FALSE, echo = FALSE}
rm(a,b,c,d,e,f,g,h,i,j,k)
```

## Development Trajectories {.tabset}

### Assumed development

The chart shows the net additional dwellings assumed in each year of the projection for the three scenarios. Data for 2012-2019 are taken from the LDD. 

```{r dev_chart, out.width = "100%"}
charts[['dev chart']]
```

### Assumed stock

The chart shows the cumulative growth in units over the projection period in each of the three scenarios.

```{r stock_chart, out.width = "100%"}
charts[['stock']]
```


# Housing-led projections Results

<a href="#top">Back to top</a>


## Comparison to the Trend

The houseing-led projections are constrained to be consistent with the Central Trend projection at the <a target="_blank"  href=https://www.ons.gov.uk/methodology/geography/ukgeographies/eurostat#london>International Territorial Level 2</a> (ITL2, previously NUTS2) aggregation level. The ITL2 sub-regions are:  
- Inner London - West  
- Inner London - East  
- Outer London - East and North East  
- Outer London - South  
- Outer London - West and North West  

As a result of this constraining, the population of each group of boroughs, and of London as a whole, is the same in all of the housing-led projections. Individual borough and ward populations do vary.


## Population change {.tabset}

<a href="#top">Back to top</a>

The housing-led projections are recommended for most uses, especially those at borough level. The maps below show the spatial distribution of growth over the projection period 2020-2041 in each of the three scenarios.

### Identified Capacity

<div class="table-title">Map 1: Population growth 2020-2041, Identified Capacity Scenario</div>
```{r shlaa_map}
charts[['shlaa map']]
```
<div class="source">Source: GLA 2021-based population projections</div>

### Past Delivery

<div class="table-title">Map 2: Population growth 2020-2041, Past Delivery Average Scenario</div>
```{r ldd_map}
charts[['ldd map']]
```
<div class="source">Source: GLA 2021-based population projections</div>

### Housing Targets

<div class="table-title">Map 3: Population growth 2020-2041, Housing Targets Scenario</div>
```{r lp_map}
charts[['lp map']]
```
<div class="source">Source: GLA 2021-based population projections</div>


## Average Household Size

<a href="#top">Back to top</a>

Average Household Size (AHS) is calculated by dividing the household population of an area by the number of households. These levels of AHS are adjusted in the model to account for past trends in population change and the amount of available housing. The results can be seen in the chart below. The Past Delivery scenario has lower housing delivery meaning population must fit into fewer households and thus raising AHS compared to the other scenarios.

```{r ahs, out.width = "100%"}
charts[['ahs']]
```

## Ward profiles

**TODO: NOT PRODUCED YET**

<a href="#top">Back to top</a>

Housing-led projections are produced for London wards and MSOAs as well as Boroughs. Due to data limitations and a reliance on census inputs the projections use 2013 ward boundaries and ward-level projections are not currently available for ward boundaries which have come into effect since 2013. A ward-level summary of the housing-led scenario projections is available through the <a target="_blank"  href=https://data.london.gov.uk/dataset/housing-led-population-projections/">London Datastore</a>.
